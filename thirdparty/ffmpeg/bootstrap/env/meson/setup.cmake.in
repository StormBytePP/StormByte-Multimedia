if(NOT EXISTS "@_MESON_BUILD_DIR@/build.ninja")
	execute_process(
		COMMAND @ENV_MESON_COMMAND@ setup "@_MESON_BUILD_DIR@" "@_MESON_SRC_DIR@" @_MESON_OPTIONS@
		RESULT_VARIABLE MESON_SETUP_RESULT
		OUTPUT_VARIABLE MESON_SETUP_OUT
		ERROR_VARIABLE MESON_SETUP_ERR
	)

	if(MESON_SETUP_VERBOSE)
		if(MESON_SETUP_OUT)
			message(STATUS "${MESON_SETUP_OUT}")
		endif()
	endif()
	if(MESON_SETUP_ERR)
		message(STATUS "${MESON_SETUP_ERR}")
	endif()
	if(NOT MESON_SETUP_RESULT EQUAL 0)
		set(MESON_LOG_FILE "@_MESON_BUILD_DIR@/meson-logs/meson-log.txt")
		if(EXISTS "${MESON_LOG_FILE}")
			file(READ "${MESON_LOG_FILE}" MESON_LOG_CONTENT)
			message(FATAL_ERROR "Meson setup failed (exit ${MESON_SETUP_RESULT}). Meson log: ${MESON_LOG_FILE}\n${MESON_LOG_CONTENT}")
		else()
			message(FATAL_ERROR "Meson setup failed (exit ${MESON_SETUP_RESULT}). See meson output above for details.")
		endif()
	endif()
endif()
message(STATUS "Configured @_MESON_COMPONENT@")